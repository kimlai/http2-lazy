(window.idzJsonpFunction=window.idzJsonpFunction||[]).push([[2],{700:function(e,t,n){var o=n(17),a=n(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(12)),r=n(18),s=a(n(744)),u=n(78),c=o(n(318)),f=n(25);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={register:function(){var e=r.idz.engagement.gdprConsent.enabled,t=r.idz.engagement.url,n=(0,s.default)(t,r.platform+"-"+r.websiteId,r.platform);function o(t){var o=t.vuid,a=t.actionId;(0,f.isChatboxV2Enabled)()?setTimeout((function(){return r.eventManager.emit(u.showChatbox,t)}),0):e?n.getConsentForVuid(o,a).then((function(e){e!==c.CONSENTED?r.eventManager.emit(u.showChatboxWithGDPRWorkflow,t):r.eventManager.emit(u.showChatbox,t)}),(function(){r.eventManager.emit(u.showChatboxWithGDPRRetrievingFailedWorkflow)})):r.eventManager.emit(u.showChatbox,t)}function a(t){var o=t.vuid,a=t.actionId;(0,f.isChatboxV2Enabled)()?setTimeout((function(){return r.eventManager.emit(u.showMessage,t)}),0):e?n.getConsentForVuid(o,a).then((function(e){e!==c.CONSENTED?r.eventManager.emit(u.showMessageWithGDPRWorkflow,t):r.eventManager.emit(u.showMessage,t)}),(function(){r.eventManager.emit(u.showMessageWithGDPRRetrievingFailedWorkflow)})):r.eventManager.emit(u.showMessage,t)}function i(t){var o=t.vuid,a=t.actionId;e?n.getConsentForVuid(o,a).then((function(e){r.eventManager.emit(u.showCallModal,l(l({},t),{},{hasConsented:e===c.CONSENTED}))}),(function(){r.eventManager.emit(u.showCallModalRetrievingFailedWorkflow)})):r.eventManager.emit(u.showCallModal,l(l({},t),{},{hasConsented:!0}))}function d(e){var t=e.vuid,o=e.actionId;n.setConsentForVuid(t,o,c.CONSENTED).then((function(){r.eventManager.emit(u.showChatboxWithAcceptedGDPRWorkflow,e)}),(function(){r.eventManager.emit(u.showChatboxWithAcceptedGDPRFailedWorkflow)}))}function h(e){var t=e.vuid,o=e.actionId;n.setConsentForVuid(t,o,c.DID_NOT_CONSENT).then((function(){r.eventManager.emit(u.showChatboxWithRefusedGDPRWorkflow)}),(function(){r.eventManager.emit(u.showChatboxWithRefusedGDPRFailedWorkflow)}))}function v(t,o,a){e?n.setConsentForVuid(t,o,c.CONSENTED).then((function(){r.eventManager.emit(u.showCallModalWithAcceptedGDPRWorkflow,a)}),(function(){r.eventManager.emit(u.showCallModalSaveConsentFailedWorkflow)})):r.eventManager.emit(u.showCallModalWithAcceptedGDPRWorkflow,a)}return r.eventManager.on(u.showChatboxButtonClicked,o),r.eventManager.on(u.showChatboxNotification,o),r.eventManager.on(u.showMessageNotification,a),r.eventManager.on(u.GDPRAccepted,d),r.eventManager.on(u.GDPRRefused,h),r.eventManager.on(u.showCallButtonClicked,i),r.eventManager.on(u.callModalSaveConsent,v),function(){r.eventManager.off(u.showChatboxButtonClicked,o),r.eventManager.off(u.showChatboxNotification,o),r.eventManager.off(u.showMessageNotification,a),r.eventManager.off(u.GDPRAccepted,d),r.eventManager.off(u.GDPRRefused,h),r.eventManager.off(u.showCallButtonClicked,i),r.eventManager.off(u.callModalSaveConsent,v)}}};t.default=h},744:function(e,t,n){var o=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(318),i=o(n(42)),r=n(18).idz.require("visitorIdentityService");t.default=function(e,t,n){return{getConsentForVuid:function(o,s){return new Promise(r.getJwtIdentity).then((function(r){var u=r?{Authorization:"Bearer "+r.jwt}:{};return i.ajaxGet({url:e+"/visitor-consents/ONSITE/"+t+"/"+o+"?actionId="+s+"&platform="+n,headers:u}).then((function(e){return!0===e.data?a.CONSENTED:a.DID_NOT_CONSENT}))}))},setConsentForVuid:function(o,s,u){return new Promise(r.getJwtIdentity).then((function(r){var c=r?{Authorization:"Bearer "+r.jwt}:{};return i.ajaxPut({url:e+"/visitor-consents/ONSITE/"+t+"/"+o+"?actionId="+s+"&platform="+n,data:(u===a.CONSENTED).toString(),headers:c})}))}}}}}]);
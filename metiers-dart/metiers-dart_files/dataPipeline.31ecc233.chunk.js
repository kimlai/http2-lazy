(window.idzJsonpFunction=window.idzJsonpFunction||[]).push([[7],{243:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.mapPromise=t.skipDuplicates=t.fromEventEmitter=t.TYPES=void 0;var i=r(163),o=n(r(691)),a=n(r(692)),u={START:0,DATA:1,STOP:2};t.TYPES=u;t.fromEventEmitter=function(e,t){return function(r,n){if(0===r){var i=function(e){return setTimeout((function(){return n(1,e)}),0)};n(0,(function(r){2===r&&e.removeListener(t,i)})),e.on(t,i)}}};t.skipDuplicates=function(e){return function(t){return function(r,n){if(0===r){var i,o={},a=e||function(e,t){return e===t};t(0,(function(e,t){0===e&&(i=t),1!==e?n(e,t):a(o,t)?i(e):(n(e,t),o=t)}))}}}};t.mapPromise=function(e){return function(t){return(0,i.pipe)(t,(0,i.map)((function(){return(0,o.default)(e.apply(void 0,arguments))})),a.default)}}},317:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyRewardSubmitted=t.SurveyRewardDisplayed=t.SurveyCommentSubmitted=t.SurveyCommentDisplayed=t.SurveyCSATSubmitted=t.SurveyCSATDisplayed=t.SurveyNPSSubmitted=t.SurveyNPSDisplayed=void 0;t.SurveyNPSDisplayed="SurveyNPSDisplayed";t.SurveyNPSSubmitted="SurveyNPSSubmitted";t.SurveyCSATDisplayed="SurveyCSATDisplayed";t.SurveyCSATSubmitted="SurveyCSATSubmitted";t.SurveyCommentDisplayed="SurveyCommentDisplayed";t.SurveyCommentSubmitted="SurveyCommentSubmitted";t.SurveyRewardDisplayed="SurveyRewardDisplayed";t.SurveyRewardSubmitted="SurveyRewardSubmitted"},694:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(163),o=n(r(695)),a=r(31),u=r(243);t.default=function(e){return(0,i.pipe)((0,i.merge)((0,o.default)(document.location.href),(0,u.fromEventEmitter)(e,a.VisitorNavigated)),(0,i.map)((function(e){return{event:"engagement.tag.loaded",properties:{url:e,referrer:document.referrer}}})))}},701:function(e,t,r){var n=r(17),i=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var n=(0,a.default)(c.idz,"eventsCollector.url",(0,c.buildHttpUrl)("engagement/live/events")),i=(0,y.default)(e),o=(0,s.default)(e),g=(0,v.default)(e),w=(0,f.default)(e),E=(0,d.default)(e,r),j=(0,l.default)(e,r),P=(0,m.default)(t),h=(0,y.getDefaultState)(),D=[o,g,w,E,j,P].filter(Boolean);(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(){(0,u.pipe)(u.merge.apply(void 0,t),(0,u.map)(O((function(){return h}))),(0,u.forEach)((function(e){b.ajaxPost({url:n,data:(0,p.JSONStringify)(e)})})))}}).apply(void 0,D)(),(0,u.pipe)(i,(0,u.map)((function(e){h=S(S({},h),e)})))};var o=i(r(12)),a=i(r(45)),u=r(163),c=r(18),p=r(86),d=i(r(760)),f=i(r(764)),l=i(r(765)),s=i(r(694)),v=i(r(766)),m=i(r(767)),y=n(r(768)),b=n(r(42));function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=function(e){return function(t){var r=e();return{event:t.event,properties:S({visitorDate:(new Date).toISOString(),projectId:r.projectId,sourceVisitorId:r.vuid,visitorLanguage:r.language,device:r.browser.device,browser:r.browser.name,url:r.navigation.url},t.properties)}}}},760:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.notificationEventMapperFactory=void 0;var i=n(r(12)),o=n(r(45)),a=n(r(110)),u=n(r(134)),c=n(r(231)),p=n(r(761)),d=r(163),f=r(31),l=r(243);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m=function(e){if("templated_notification"===e.type)return"FIXED"===e.parameters.type?[(0,c.default)(e.parameters.button.channel)]:e.parameters.buttons.map((function(e){return(0,c.default)(e.channel)}));var t=(0,o.default)(e,"channel.type","tag");return"both"===t?["chat","call"]:[t]},y=function(e){return(0,o.default)(e,"notification.id")},b=function(e){return function(t,r){return void 0===r&&(r=[]),function(n){var i=n.action,o=(0,p.default)(n,r),c=(0,a.default)(e,(function(e){return(0,u.default)(e.actions,{id:i.id})}));return{event:t,properties:v({notificationId:""+i.id,notificationType:i.type,notificationChannels:m(i),engagementRuleId:""+c.id,notificationTemplateId:y(i)},o)}}}};t.notificationEventMapperFactory=b;t.default=function(e,t){var r=b(t),n=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationDisplayed),(0,d.map)(r("engagement.notification.displayed"))),i=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationClicked),(0,d.map)(r("engagement.notification.clicked"))),o=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationHidden),(0,d.map)(r("engagement.notification.hidden",["cause"]))),a=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationClosed),(0,d.map)(r("engagement.notification.closed"))),u=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationMinimized),(0,d.map)(r("engagement.notification.minimized"))),c=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationMaximized),(0,d.map)(r("engagement.notification.maximized"))),p=(0,d.pipe)((0,l.fromEventEmitter)(e,f.EngagementNotificationMoved),(0,d.map)(r("engagement.notification.moved",["offsetX","offsetY"])));return(0,d.merge)(n,i,o,a,u,c,p)}},764:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ruleEventMapper=void 0;var n=r(163),i=r(31),o=r(243),a=function(e){return function(t){return{event:e,properties:{engagementRuleId:""+t.id}}}};t.ruleEventMapper=a;t.default=function(e){var t=(0,n.pipe)((0,o.fromEventEmitter)(e,i.EngagementRuleCountExecute),(0,n.map)(a("engagement.rule.executed"))),r=(0,n.pipe)((0,o.fromEventEmitter)(e,i.EngagementRuleCountMissedDisplay),(0,n.map)(a("engagement.rule.displayMissed")));return(0,n.merge)(t,r)}},765:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.fromEventWithMappingFactory=t.surveyEventToEmitterMapper=void 0;var n=r(163),i=r(317),o=r(243),a=function(e){return function(t){return{event:e,properties:{chatId:t.chatId,rewardId:t.reward,conversationId:t.conversationId}}}};t.surveyEventToEmitterMapper=a;var u=function(e){return function(t,r){return(0,n.pipe)((0,o.fromEventEmitter)(e,t),(0,n.map)(a(r)))}};t.fromEventWithMappingFactory=u;t.default=function(e){var t=u(e);return(0,n.merge)(t(i.SurveyNPSDisplayed,"conversations.surveyNPS.displayed"),t(i.SurveyNPSSubmitted,"conversations.surveyNPS.submitted"),t(i.SurveyCSATDisplayed,"conversations.surveyCSAT.displayed"),t(i.SurveyCSATSubmitted,"conversations.surveyCSAT.submitted"),t(i.SurveyCommentDisplayed,"conversations.surveyComment.displayed"),t(i.SurveyCommentSubmitted,"conversations.surveyComment.submitted"),t(i.SurveyRewardDisplayed,"employment.surveyReward.displayed"),t(i.SurveyRewardSubmitted,"employment.surveyReward.submitted"))}},766:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(r(12)),o=r(163),a=r(18),u=r(31),c=r(243),p=r(414);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var l=a.idz.require("visitorIdentityService"),s=function(e){return function(t){var r=void 0===t?{}:t,n=r.jwtIdentity,i=r.cause,o=r.error;return{event:e,properties:{authenticationType:n?n.type:null,authenticatedVuid:n?n.vuid:null,cause:i,error:o}}}};t.default=function(e){var t=(0,p.promisifyFn)(l.getAnonymousVuid)(),r=(0,o.pipe)((0,c.fromEventEmitter)(e,u.AuthenticatedSessionStarted),(0,o.map)(s("engagement.visitor.authentication.authenticated.session.started"))),n=(0,o.pipe)((0,c.fromEventEmitter)(e,u.AuthenticatedSessionFinished),(0,o.map)(s("engagement.visitor.authentication.authenticated.session.finished")));return(0,o.pipe)((0,o.merge)(r,n),(0,c.mapPromise)((function(e){return t.then((function(t){return f(f({},e),{},{properties:f(f({},e.properties),{},{anonymousVuid:t})})}))})))}},767:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.fromEventWithMappingFactory=t.orchestratorEventToEmitterMapper=void 0;var i=r(163),o=r(243),a=n(r(305)),u=function(){return function(e){return{event:e.name,properties:e.properties}}};t.orchestratorEventToEmitterMapper=u;var c=function(e){return function(t){return(0,i.pipe)((0,o.fromEventEmitter)(e,t),(0,i.map)((function(e){return{event:e.name,properties:e.properties}})))}};t.fromEventWithMappingFactory=c;t.default=function(e){var t=c(e);return(0,i.merge)(t(a.default))}},768:function(e,t,r){var n=r(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.getDefaultState=t.locationUrlCallbag=t.scrollYCallbag=t.browserWidthCallbag=t.browserHeightCallbag=t.browserResizeCallbag=t.getInitialState=t.stateScanner=void 0;var i=n(r(12)),o=r(769),a=r(163),u=n(r(695)),c=n(r(770)),p=n(r(135)),d=r(771),f=n(r(246)),l=r(243),s=n(r(694)),v=n(r(772));function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b=a.fromEvent.default,g=function(e,t){return(0,c.default)(e,t.propertyType,t.propertyValue)};t.stateScanner=g;var S=function(e,t,r,n,i,o,a,u){return(0,p.default)([(0,v.default)("vuid",e),(0,v.default)("platform",t),(0,v.default)("websiteId",r),(0,v.default)("language",n),(0,v.default)("projectId",t+"-"+r),(0,v.default)("browser.name",i),(0,v.default)("browser.version",o),(0,v.default)("browser.os",a),(0,v.default)("browser.device",u)],g,{})};t.getInitialState=S;var O=function(){return(0,a.pipe)((0,a.merge)((0,u.default)("initial size"),b(window,"resize")),(0,o.debounce)(500))};t.browserResizeCallbag=O;var w=function(){return(0,a.pipe)(O(),(0,a.map)((function(){return window.innerHeight})),(0,l.skipDuplicates)(),(0,a.map)((function(e){return(0,v.default)("browser.size.height",e)})))};t.browserHeightCallbag=w;var E=function(){return(0,a.pipe)(O(),(0,a.map)((function(){return window.innerWidth})),(0,l.skipDuplicates)(),(0,a.map)((function(e){return(0,v.default)("browser.size.width",e)})))};t.browserWidthCallbag=E;var j=function(){return(0,a.pipe)((0,a.merge)((0,u.default)("initial scroll"),b(window,"scroll")),(0,o.debounce)(1e3),(0,a.map)((function(){return(0,v.default)("browser.scrollY",window.scrollY)})))};t.scrollYCallbag=j;var P=function(e){return(0,a.pipe)((0,s.default)(e),(0,a.map)((function(e){return(0,v.default)("navigation.url",e.properties.url)})))};t.locationUrlCallbag=P;t.getDefaultState=function(){var e=(0,d.extractMandatoryDataFromGlobalObject)(),t=e.vuid,r=e.platform,n=e.websiteId,i=e.language,o=(0,f.default)(),a=o.browser,u=o.version,c=o.OS,p=o.deviceType;return y(y({},S(t,r,n,i,a,u,c,p)),{},{navigation:{url:document.location.href}})};t.default=function(e){var t=(0,d.extractMandatoryDataFromGlobalObject)(),r=t.vuid,n=t.platform,i=t.websiteId,o=t.language,u=(0,f.default)(),c=u.browser,l=u.version,s=u.OS,v=u.deviceType,m=S(r,n,i,o,c,l,s,v);return(0,a.pipe)((0,a.combine)(w(),E(),j(),P(e)),(0,a.map)((function(e){return(0,p.default)(e,g,m)})))}},771:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.extractMandatoryDataFromGlobalObject=void 0;t.extractMandatoryDataFromGlobalObject=function(){return{vuid:window.iAdvize.vuid,platform:window.iAdvize.platform,websiteId:window.iAdvize.website_id,language:window.iAdvize.curlang}}},772:function(e,t){e.exports=function(e,t){return{propertyType:e,propertyValue:t,action:"Set"}}}}]);